<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Home power consumption monitoring using ESP32</title><link rel="stylesheet" href="./../assets/built/screen.css?v=85d7e3c861"><link rel="canonical" href="https://codetiger.github.io/blog/home-power-consumption-monitoring-using-esp32/"><meta name="referrer" content="no-referrer-when-downgrade"><link rel="amphtml" href="https://codetiger.github.io/blog/home-power-consumption-monitoring-using-esp32/amp/"><meta property="og:site_name" content="Small World"><meta property="og:type" content="article"><meta property="og:title" content="Home power consumption monitoring using ESP32"><meta property="og:description" content="Its always fun to collect data around you and understand your needs better. When
it comes to power consumption, end of the month bill gives us a pretty good
view, but I wanted to make it slightly interesting. I wanted to collect power
consumption every second in my house and"><meta property="og:url" content="https://codetiger.github.io/blog/home-power-consumption-monitoring-using-esp32/"><meta property="og:image" content="https://codetiger.github.io/blog/content/images/2022/01/home-monitoring-grafana-dashboard.jpg"><meta property="article:published_time" content="2021-12-28T07:49:57.000Z"><meta property="article:modified_time" content="2022-01-18T03:48:49.000Z"><meta property="article:tag" content="ESP32"><meta property="article:tag" content="raspberry pi"><meta property="article:tag" content="CT-sensor"><meta property="article:tag" content="electronics"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="Home power consumption monitoring using ESP32"><meta name="twitter:description" content="Its always fun to collect data around you and understand your needs better. When
it comes to power consumption, end of the month bill gives us a pretty good
view, but I wanted to make it slightly interesting. I wanted to collect power
consumption every second in my house and"><meta name="twitter:url" content="https://codetiger.github.io/blog/home-power-consumption-monitoring-using-esp32/"><meta name="twitter:image" content="https://codetiger.github.io/blog/content/images/2022/01/home-monitoring-grafana-dashboard.jpg"><meta name="twitter:label1" content="Written by"><meta name="twitter:data1" content="Harishankar"><meta name="twitter:label2" content="Filed under"><meta name="twitter:data2" content="ESP32, raspberry pi, CT-sensor, electronics"><meta name="twitter:site" content="@codetiger"><meta name="twitter:creator" content="@codetiger"><meta property="og:image:width" content="1920"><meta property="og:image:height" content="948"><script type="application/ld+json">{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Small World",
        "url": "https://codetiger.github.io/blog/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://codetiger.github.io/blog/favicon.ico",
            "width": 48,
            "height": 48
        }
    },
    "author": {
        "@type": "Person",
        "name": "Harishankar",
        "image": {
            "@type": "ImageObject",
            "url": "https://codetiger.github.io/blog/content/images/2021/12/triangulated-image.jpg",
            "width": 768,
            "height": 849
        },
        "url": "https://codetiger.github.io/blog/author/codetiger/",
        "sameAs": [
            "https://twitter.com/codetiger"
        ]
    },
    "headline": "Home power consumption monitoring using ESP32",
    "url": "https://codetiger.github.io/blog/home-power-consumption-monitoring-using-esp32/",
    "datePublished": "2021-12-28T07:49:57.000Z",
    "dateModified": "2022-01-18T03:48:49.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://codetiger.github.io/blog/content/images/2022/01/home-monitoring-grafana-dashboard.jpg",
        "width": 1920,
        "height": 948
    },
    "keywords": "ESP32, raspberry pi, CT-sensor, electronics",
    "description": "Its always fun to collect data around you and understand your needs better. When\nit comes to power consumption, end of the month bill gives us a pretty good\nview, but I wanted to make it slightly interesting. I wanted to collect power\nconsumption every second in my house and see how the data looks like. \n\nComponents used:\n 1. ESP WROOM 32 MCU Module - (Robu.in\n    [https://robu.in/product/esp-wroom-32-wifi-bluetooth-networking-smart-component-development-board/]\n    )\n 2. SCT-013-030 Non-invasiv",
    "mainEntityOfPage": "https://codetiger.github.io/blog/home-power-consumption-monitoring-using-esp32/"
}</script><meta name="generator" content="Ghost 5.59"><link rel="alternate" type="application/rss+xml" title="Small World" href="https://codetiger.github.io/blog/rss/"><script defer="defer" src="https://cdn.jsdelivr.net/ghost/sodo-search@~1.1/umd/sodo-search.min.js" data-key="c2656377eaeb4efcb5165d9654" data-styles="https://cdn.jsdelivr.net/ghost/sodo-search@~1.1/umd/main.css" data-sodo-search="https://codetiger.github.io/blog/" crossorigin="anonymous"></script><link href="https://codetiger.github.io/blog/webmentions/receive/" rel="webmention"><script defer="defer" src="./../public/cards.min.js?v=85d7e3c861"></script><link rel="stylesheet" type="text/css" href="./../public/cards.min.css?v=85d7e3c861"><style type="text/css">/* Hide the Membership aka Subscribe actions etc. */
    #ghost-portal-root,
    a[href^="https://ghost.org"],
    a[href^="#/portal/signup"] { display: none; }
    .footer-cta { display: none; }</style><style>:root {--ghost-accent-color: #874efe;}</style></head><body class="post-template tag-esp32 tag-raspberry-pi tag-ct-sensor tag-electronics is-head-middle-logo"><div class="gh-site"><header id="gh-head" class="gh-head gh-outer"><div class="gh-head-inner gh-inner"><div class="gh-head-brand"><div class="gh-head-brand-wrapper"><a class="gh-head-logo" href="https://codetiger.github.io/blog">Small World</a></div><button class="gh-search gh-icon-btn" data-ghost-search><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" width="20" height="20"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></button> <button class="gh-burger"></button></div><nav class="gh-head-menu"><ul class="nav"><li class="nav-home"><a href="https://codetiger.github.io/blog/">Home</a></li><li class="nav-about"><a href="https://codetiger.github.io/blog/about-me/">About</a></li></ul></nav><div class="gh-head-actions"><button class="gh-search gh-icon-btn" data-ghost-search><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" width="20" height="20"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></button></div></div></header><div class="site-content"><main class="site-main"><article class="gh-article post tag-esp32 tag-raspberry-pi tag-ct-sensor tag-electronics"><header class="gh-article-header gh-canvas"><span class="gh-article-meta">By <a href="./../author/codetiger/">Harishankar</a> in <a class="gh-article-tag" href="https://codetiger.github.io/blog/tag/esp32/">ESP32</a> â€” <time datetime="2021-12-28">Dec 28, 2021</time></span><h1 class="gh-article-title">Home power consumption monitoring using ESP32</h1><figure class="gh-article-image kg-width-wide"><img srcset="./../content/images/size/w400/2022/01/home-monitoring-grafana-dashboard.jpg 400w, ./../content/images/size/w720/2022/01/home-monitoring-grafana-dashboard.jpg 720w, ./../content/images/size/w960/2022/01/home-monitoring-grafana-dashboard.jpg 960w, ./../content/images/size/w1200/2022/01/home-monitoring-grafana-dashboard.jpg 1200w, ./../content/images/size/w2000/2022/01/home-monitoring-grafana-dashboard.jpg 2000w" sizes="(max-width: 1200px) 100vw, 1200px" src="./../content/images/size/w1200/2022/01/home-monitoring-grafana-dashboard.jpg" alt="Home power consumption monitoring using ESP32"><figcaption>Home Energy Monitoring Grafana Dashboard</figcaption></figure></header><div class="gh-content gh-canvas"><p>Its always fun to collect data around you and understand your needs better. When it comes to power consumption, end of the month bill gives us a pretty good view, but I wanted to make it slightly interesting. I wanted to collect power consumption every second in my house and see how the data looks like.</p><h3 id="components-used">Components used:</h3><ol><li>ESP WROOM 32 MCU Module - (<a href="https://robu.in/product/esp-wroom-32-wifi-bluetooth-networking-smart-component-development-board/?ref=localhost">Robu.in</a>)</li><li>SCT-013-030 Non-invasive AC Current Sensor Clamp Sensor - (<a href="https://robu.in/product/sct-013-030-non-invasive-ac-current-sensor-clamp-sensor-30a/?ref=localhost">Robu.in</a>)</li><li>100k Ohm resistors - 2 pieces</li><li>10uF capacitor - 1 piece</li><li>3.5mm jack female connector - 1 piece</li></ol><h3 id="wiring-diagram">Wiring diagram:</h3><p>The wiring diagram were taken mostly from <a href="https://savjee.be/2019/07/Home-Energy-Monitor-ESP32-CT-Sensor-Emonlib/?ref=localhost">this article</a> and <a href="https://openenergymonitor.org/?ref=localhost">OpenEnergyMonitor</a> project. The wiring diagram is same as the standard ones mentioned in these websites. I just didn't want to copy or redo the same as the other articles are already explaining these things at the best.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="./..//content/images/2021/12/esp32-energy-monitor-front.jpg" class="kg-image" alt loading="lazy" width="2000" height="3012" srcset="https://codetiger.github.io/blog/content/images/size/w600/2021/12/esp32-energy-monitor-front.jpg 600w, https://codetiger.github.io/blog/content/images/size/w1000/2021/12/esp32-energy-monitor-front.jpg 1000w, https://codetiger.github.io/blog/content/images/size/w1600/2021/12/esp32-energy-monitor-front.jpg 1600w, https://codetiger.github.io/blog/content/images/2021/12/esp32-energy-monitor-front.jpg 2112w" sizes="(min-width: 720px) 720px"><figcaption>ESP32 Energy Monitor Circuit</figcaption></figure><figure class="kg-card kg-image-card kg-card-hascaption"><img src="./..//content/images/2021/12/esp32-energy-monitor-back.jpg" class="kg-image" alt loading="lazy" width="2000" height="2830" srcset="https://codetiger.github.io/blog/content/images/size/w600/2021/12/esp32-energy-monitor-back.jpg 600w, https://codetiger.github.io/blog/content/images/size/w1000/2021/12/esp32-energy-monitor-back.jpg 1000w, https://codetiger.github.io/blog/content/images/size/w1600/2021/12/esp32-energy-monitor-back.jpg 1600w, https://codetiger.github.io/blog/content/images/2021/12/esp32-energy-monitor-back.jpg 2087w" sizes="(min-width: 720px) 720px"><figcaption>ESP32 Energy Monitor Circuit</figcaption></figure><p>As you can clearly see, my soldering skills are not that great. :-)</p><h3 id="software">Software:</h3><p>With not much changes in the hardware, I did a lot of research on making the software better. Especially with ESP32 having issues in accuracy with its ADC controller, I spent a lot of time making it better.<br>I used the open source Emon library and added a look up table for my ESP32 ADC which gives a very good results in accurately measuring the analog input. As it is well known each ESP32 needs to be calibrated for ADC. While the recently manufactured ESP32 are calibrated at factory, I still didn't find it quite accurate in my case. So I calibrated and generated a look up table for my chip. The calibration code is available <a href="https://github.com/e-tinkers/esp32-adc-calibrate?ref=localhost">here</a>.</p><p>The entire code is available here: <a href="https://github.com/codetiger/PowerConsumptionMonitor-ESP32?ref=localhost">ESP32 Home energy monitoring</a></p><p>The ESP32 sketch works as a prometheus exporter making it easy to log the data easily in timeseries. Prometheus also has been my personal favourite in terms of resource usage.</p><figure class="kg-card kg-image-card"><img src="./..//content/images/2021/12/energy-monitor-grafana.jpg" class="kg-image" alt loading="lazy" width="1915" height="980" srcset="https://codetiger.github.io/blog/content/images/size/w600/2021/12/energy-monitor-grafana.jpg 600w, https://codetiger.github.io/blog/content/images/size/w1000/2021/12/energy-monitor-grafana.jpg 1000w, https://codetiger.github.io/blog/content/images/size/w1600/2021/12/energy-monitor-grafana.jpg 1600w, https://codetiger.github.io/blog/content/images/2021/12/energy-monitor-grafana.jpg 1915w" sizes="(min-width: 720px) 720px"></figure><p>Finally the data is available in Grafana. As I already have a Raspberry Pi running in my house for various other things, I added Prometheus and Grafana for monitoring the energy consumption as well.</p><h3 id="final-packing">Final packing:</h3><figure class="kg-card kg-image-card kg-card-hascaption"><img src="./..//content/images/2021/12/E391E3DB-AEEA-4FEA-B16F-1BF1C112E07D_1_105_c.jpeg" class="kg-image" alt loading="lazy" width="768" height="1024" srcset="https://codetiger.github.io/blog/content/images/size/w600/2021/12/E391E3DB-AEEA-4FEA-B16F-1BF1C112E07D_1_105_c.jpeg 600w, https://codetiger.github.io/blog/content/images/2021/12/E391E3DB-AEEA-4FEA-B16F-1BF1C112E07D_1_105_c.jpeg 768w" sizes="(min-width: 720px) 720px"><figcaption>ESP32 + SCT-13-030 CT sensor for home power monitoring</figcaption></figure></div></article><div class="gh-canvas"><div class="navigation"><a class="navigation-item navigation-previous" href="./../ground-station/"><span class="navigation-label">Previous</span><h4 class="navigation-title">RaLiSat-1 Base station system design</h4></a><a class="navigation-item navigation-next" href="./../remote-epaper-display-using-esp32/"><span class="navigation-label">Next</span><h4 class="navigation-title">Remote ePaper display using ESP32</h4></a></div></div><div class="related-wrapper gh-outer"><section class="related-posts gh-inner"><h3 class="related-title"><span class="text">You might also like...</span></h3><div class="post-feed"><article class="post tag-electronics tag-esp32 tag-raspberry-pi tag-epaper tag-eink tag-display u-shadow"><a class="post-link" href="./../remote-epaper-display-using-esp32/"><figure class="post-media"><div class="u-placeholder same-height rectangle"><img class="post-image u-object-fit" srcset="./../content/images/size/w400/2022/01/E695CC21-D1FA-4CEA-865C-77B266A02730_1_105_c.jpeg 400w, ./../content/images/size/w720/2022/01/E695CC21-D1FA-4CEA-865C-77B266A02730_1_105_c.jpeg 750w, ./../content/images/size/w960/2022/01/E695CC21-D1FA-4CEA-865C-77B266A02730_1_105_c.jpeg 960w, ./../content/images/size/w1200/2022/01/E695CC21-D1FA-4CEA-865C-77B266A02730_1_105_c.jpeg 1140w, ./../content/images/size/w2000/2022/01/E695CC21-D1FA-4CEA-865C-77B266A02730_1_105_c.jpeg 1920w" sizes="600px" src="./../content/images/size/w960/2022/01/E695CC21-D1FA-4CEA-865C-77B266A02730_1_105_c.jpeg" alt="Remote ePaper display using ESP32" loading="lazy"></div></figure><div class="post-wrapper"><header class="post-header"><span class="post-tag">electronics</span><h2 class="post-title">Remote ePaper display using ESP32</h2></header><div class="post-excerpt">I had a 7.8 inch ePaper display from Waveshare lying around</div></div><footer class="post-footer"><span class="post-more">Read More</span><div class="post-author"><span class="post-author-link"><img class="post-author-image" src="./../content/images/size/w150/2021/12/triangulated-image.jpg" alt="Harishankar" loading="lazy"></span></div></footer></a></article><article class="post tag-ralisat-1 tag-near-space tag-electronics tag-gps tag-lora tag-raspberry-pi no-image u-shadow"><a class="post-link" href="./../ralisat-1-payload-design/"><div class="post-wrapper"><header class="post-header"><span class="post-tag">RaLiSat-1</span><h2 class="post-title">RaLiSat-1 Payload system design</h2></header><div class="post-excerpt">To start with, I had basic goals for designing the payload system.</div></div><footer class="post-footer"><span class="post-more">Read More</span><div class="post-author"><span class="post-author-link"><img class="post-author-image" src="./../content/images/size/w150/2021/12/triangulated-image.jpg" alt="Harishankar" loading="lazy"></span></div></footer></a></article><article class="post tag-ralisat-1 tag-near-space tag-gps tag-lora tag-raspberry-pi u-shadow"><a class="post-link" href="./../dream-of-reaching-near-space-using-high-altitude-balloon/"><figure class="post-media"><div class="u-placeholder same-height rectangle"><img class="post-image u-object-fit" srcset="./../content/images/size/w400/2022/05/hab-15-175602-1.jpg 400w, ./../content/images/size/w720/2022/05/hab-15-175602-1.jpg 750w, ./../content/images/size/w960/2022/05/hab-15-175602-1.jpg 960w, ./../content/images/size/w1200/2022/05/hab-15-175602-1.jpg 1140w, ./../content/images/size/w2000/2022/05/hab-15-175602-1.jpg 1920w" sizes="600px" src="./../content/images/size/w960/2022/05/hab-15-175602-1.jpg" alt="The dream of reaching near space" loading="lazy"></div></figure><div class="post-wrapper"><header class="post-header"><span class="post-tag">RaLiSat-1</span><h2 class="post-title">The dream of reaching near space</h2></header><div class="post-excerpt">Story from 1990s: Around the 1990s, my parents moved to a rented</div></div><footer class="post-footer"><span class="post-more">Read More</span><div class="post-author"><span class="post-author-link"><img class="post-author-image" src="./../content/images/size/w150/2021/12/triangulated-image.jpg" alt="Harishankar" loading="lazy"></span></div></footer></a></article><article class="post tag-near-space tag-ralisat-1 tag-raspberry-pi tag-lora tag-electronics no-image u-shadow"><a class="post-link" href="./../ground-station/"><div class="post-wrapper"><header class="post-header"><span class="post-tag">Near Space</span><h2 class="post-title">RaLiSat-1 Base station system design</h2></header><div class="post-excerpt">For my high altitude balloon project, I am designing a portable base</div></div><footer class="post-footer"><span class="post-more">Read More</span><div class="post-author"><span class="post-author-link"><img class="post-author-image" src="./../content/images/size/w150/2021/12/triangulated-image.jpg" alt="Harishankar" loading="lazy"></span></div></footer></a></article></div></section></div></main></div><footer class="gh-foot gh-outer"><div class="gh-foot-inner gh-inner"><div class="gh-copyright">Small World Â© 2023</div><nav class="gh-foot-menu"></nav><div class="gh-powered-by"><a href="https://ghost.org/" target="_blank" rel="noopener">Powered by Ghost</a></div></div></footer></div><div class="pswp" tabindex="-1" role="dialog" aria-hidden="true"><div class="pswp__bg"></div><div class="pswp__scroll-wrap"><div class="pswp__container"><div class="pswp__item"></div><div class="pswp__item"></div><div class="pswp__item"></div></div><div class="pswp__ui pswp__ui--hidden"><div class="pswp__top-bar"><div class="pswp__counter"></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button> <button class="pswp__button pswp__button--share" title="Share"></button> <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button> <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class="pswp__preloader"><div class="pswp__preloader__icn"><div class="pswp__preloader__cut"><div class="pswp__preloader__donut"></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class="pswp__share-tooltip"></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button> <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class="pswp__caption"><div class="pswp__caption__center"></div></div></div></div></div><script src="./../assets/built/main.min.js?v=85d7e3c861"></script></body></html>