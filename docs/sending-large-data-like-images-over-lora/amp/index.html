<!doctype html><html ⚡><meta charset=utf-8><meta name=viewport content="width=device-width,minimum-scale=1,initial-scale=1"><title>Sending large data like images over Lora</title><link rel=canonical href=https://codetiger.github.io/blog/sending-large-data-like-images-over-lora/><meta name=referrer content="no-referrer-when-downgrade"><meta property="og:site_name" content="Small World"><meta property="og:type" content="article"><meta property="og:title" content="Sending large data like images over Lora"><meta property="og:description" content="Got obsessed with the Lora module E32-868T30D after playing with it for couple of months now. To be honest, this seemed to me like a life saver for hobbyists to start on RF. My previous attempts failed with I had to add RF to my projects. This time it was"><meta property="og:url" content="https://codetiger.github.io/blog/sending-large-data-like-images-over-lora/"><meta property="og:image" content="https://codetiger.github.io/blog/content/images/2021/11/IMG_1667-1.jpeg"><meta property="article:published_time" content="2021-12-06T13:13:23.000Z"><meta property="article:modified_time" content="2021-12-06T13:13:23.000Z"><meta property="article:tag" content="lora"><meta property="article:tag" content="raspberry pi"><meta property="article:tag" content="electronics"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="Sending large data like images over Lora"><meta name=twitter:description content="Got obsessed with the Lora module E32-868T30D after playing with it for couple of months now. To be honest, this seemed to me like a life saver for hobbyists to start on RF. My previous attempts failed with I had to add RF to my projects. This time it was"><meta name=twitter:url content="https://codetiger.github.io/blog/sending-large-data-like-images-over-lora/"><meta name=twitter:image content="https://codetiger.github.io/blog/content/images/2021/11/IMG_1667-1.jpeg"><meta name=twitter:label1 content="Written by"><meta name=twitter:data1 content="Harishankar"><meta name=twitter:label2 content="Filed under"><meta name=twitter:data2 content="lora, raspberry pi, electronics"><meta name=twitter:site content="@codetiger"><meta name=twitter:creator content="@codetiger"><meta property="og:image:width" content="2000"><meta property="og:image:height" content="1500"><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","publisher":{"@type":"Organization","name":"Small World","url":"https://codetiger.github.io/blog/","logo":{"@type":"ImageObject","url":"https://codetiger.github.io/blog/favicon.ico","width":48,"height":48}},"author":{"@type":"Person","name":"Harishankar","image":{"@type":"ImageObject","url":"https://codetiger.github.io/blog/content/images/2021/12/triangulated-image.jpg","width":768,"height":849},"url":"https://codetiger.github.io/blog/author/codetiger/","sameAs":["https://twitter.com/codetiger"]},"headline":"Sending large data like images over Lora","url":"https://codetiger.github.io/blog/sending-large-data-like-images-over-lora/","datePublished":"2021-12-06T13:13:23.000Z","dateModified":"2021-12-06T13:13:23.000Z","keywords":"lora, raspberry pi, electronics","description":"Got obsessed with the Lora module E32-868T30D after playing with it for couple\nof months now. To be honest, this seemed to me like a life saver for hobbyists\nto start on RF. My previous attempts failed with I had to add RF to my projects.\nThis time it was mostly a plug and play with simple configurations. \n\nSpeed: \nI read everywhere saying Lora is for smaller data packets and are not meant for\nlarger data like images. There were some calculations showing Lora would take\nhours or days to transfer","mainEntityOfPage":{"@type":"WebPage","@id":"https://codetiger.github.io/blog/"}}</script><meta name=generator content="Ghost 4.24"><link rel=alternate type=application/rss+xml title="Small World" href=https://codetiger.github.io/blog/rss/><style amp-custom>*,*::before,*::after{box-sizing:border-box}html{overflow-x:hidden;overflow-y:scroll;font-size:62.5%;-webkit-tap-highlight-color:transparent}body{min-height:100vh;margin:0;padding:0;color:#3a4145;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;font-size:1.7rem;line-height:1.55em;font-weight:400;font-style:normal;background:#fff;scroll-behavior:smooth;overflow-x:hidden;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}p,ul,ol,li,dl,dd,hr,pre,form,table,video,figure,figcaption,blockquote{margin:0;padding:0}ul[class],ol[class]{padding:0;list-style:none}img{display:block;max-width:100%}input,button,select,textarea{font:inherit;-webkit-appearance:none}fieldset{margin:0;padding:0;border:0}label{display:block;font-size:.9em;font-weight:700}hr{position:relative;display:block;width:100%;height:1px;border:0;border-top:1px solid;opacity:.1}::selection{text-shadow:none;background:#cbeafb}mark{background-color:#fdffb6}small{font-size:80%}sub,sup{position:relative;font-size:75%;line-height:0;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}ul li+li{margin-top:.6em}a{color:var(--ghost-accent-color,#1292EE);text-decoration-skip-ink:auto}h1,h2,h3,h4,h5,h6{margin:0;font-weight:700;color:#121212;line-height:1.4em}h1{font-size:3.4rem;line-height:1.1em}h2{font-size:2.4rem;line-height:1.2em}h3{font-size:1.8rem}h4{font-size:1.7rem}h5{font-size:1.6rem}h6{font-size:1.6rem}amp-img{height:100%;width:100%;max-width:100%;max-height:100%}amp-img img{object-fit:cover}.page-header{padding:50px 5vmin 30px;text-align:center;font-size:2rem;text-transform:uppercase;letter-spacing:.5px}.page-header a{color:#121212;font-weight:700;text-decoration:none;font-size:1.6rem;letter-spacing:-.1px}.post{max-width:680px;margin:0 auto}.post-header{margin:0 5vmin 5vmin;text-align:center}.post-meta{margin:1rem 0 0;text-transform:uppercase;color:#738a94;font-weight:500;font-size:1.3rem}.post-image{margin:0 0 5vmin}.post-image img{display:block;width:100%;height:auto}.post-content{padding:0 5vmin}.post-content>*+*{margin-top:1.5em}.post-content [id]:not(:first-child){margin:2em 0 0}.post-content>[id]+*{margin-top:1rem}.post-content [id]+.kg-card,.post-content blockquote+.kg-card{margin-top:40px}.post-content>ul,.post-content>ol,.post-content>dl{padding-left:1.9em}.post-content hr{margin-top:40px}.post .post-content hr+*{margin-top:40px}.post-content amp-img{background-color:#f8f8f8}.post-content blockquote{position:relative;font-style:italic}.post-content blockquote::before{content:"";position:absolute;left:-1.5em;top:0;bottom:0;width:.3rem;background:var(--ghost-accent-color,#1292EE)}.post-content :not(.kg-card):not([id])+.kg-card{margin-top:40px}.post-content .kg-card+:not(.kg-card){margin-top:40px}.kg-card figcaption{padding:1.5rem 1.5rem 0;text-align:center;font-weight:500;font-size:1.3rem;line-height:1.4em;opacity:.6}.kg-card figcaption strong{color:rgba(0,0,0,.8)}.post-content :not(pre) code{vertical-align:middle;padding:.15em .4em;border:#e1eaef 1px solid;font-weight:400;font-size:.9em;line-height:1em;color:#15171a;background:#f0f6f9;border-radius:.25em}.post-content>pre{overflow:scroll;padding:16px 20px;color:#fff;background:#1f2428;border-radius:5px;box-shadow:0 2px 6px -2px rgba(0,0,0,.1),0 0 1px rgba(0,0,0,.4)}.kg-embed-card{display:flex;flex-direction:column;align-items:center;width:100%}.kg-image-card img{margin:auto}.kg-gallery-card+.kg-gallery-card{margin-top:.75em}.kg-gallery-container{position:relative}.kg-gallery-row{display:flex;flex-direction:row;justify-content:center}.kg-gallery-image{width:100%;height:100%}.kg-gallery-row:not(:first-of-type){margin:.75em 0 0}.kg-gallery-image:not(:first-of-type){margin:0 0 0 .75em}.kg-bookmark-card,.kg-bookmark-publisher{position:relative}.kg-bookmark-container,.kg-bookmark-container:hover{display:flex;flex-wrap:wrap;flex-direction:row-reverse;color:currentColor;background:rgba(255,255,255,.6);font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;text-decoration:none;border-radius:5px;box-shadow:0 2px 6px -2px rgba(0,0,0,.1),0 0 1px rgba(0,0,0,.4);overflow:hidden}.kg-bookmark-content{flex-basis:0;flex-grow:999;padding:20px;order:1}.kg-bookmark-title{font-weight:600;font-size:1.5rem;line-height:1.3em}.kg-bookmark-description{display:-webkit-box;max-height:45px;margin:.5em 0 0;font-size:1.4rem;line-height:1.55em;overflow:hidden;opacity:.8;-webkit-line-clamp:2;-webkit-box-orient:vertical}.kg-bookmark-metadata{margin-top:20px}.kg-bookmark-metadata{display:flex;align-items:center;font-weight:500;font-size:1.3rem;line-height:1.3em;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.kg-bookmark-description{display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2;overflow:hidden}.kg-bookmark-metadata amp-img{width:18px;height:18px;max-width:18px;max-height:18px;margin-right:10px}.kg-bookmark-thumbnail{display:flex;flex-basis:20rem;flex-grow:1;justify-content:flex-end}.kg-bookmark-thumbnail amp-img{max-height:200px}.kg-bookmark-author{white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.kg-bookmark-publisher::before{content:"•";margin:0 .5em}.kg-nft-card-container{position:relative;display:flex;flex:auto;flex-direction:column;text-decoration:none;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;font-size:1.4rem;font-weight:400;box-shadow:0 2px 6px -2px rgb(0 0 0/.1),0 0 1px rgb(0 0 0/.4);width:100%;max-width:512px;color:#15212a;background:#fff;border-radius:5px;transition:none;margin:0 auto}.kg-nft-metadata{padding:2rem}.kg-nft-image-container{position:relative}.kg-nft-image{display:flex;border-radius:5px 5px 0 0}.kg-nft-header{display:flex;justify-content:space-between;align-items:flex-start;gap:20px}.kg-nft-header h4.kg-nft-title{font-size:1.9rem;font-weight:700;margin:0;color:#15212a}.kg-nft-header amp-img{max-width:114px;max-height:26px}.kg-nft-opensea-logo{margin-top:2px;width:100px}.kg-nft-creator{font-family:inherit;color:#95a1ad}.kg-nft-creator span{font-weight:500;color:#15212a}.kg-nft-card p.kg-nft-description{font-size:1.4rem;line-height:1.4em;margin:2rem 0 0;color:#222}.kg-button-card{display:flex;position:static;align-items:center;width:100%;justify-content:center}.kg-btn{display:flex;position:static;align-items:center;padding:0 2rem;height:4rem;line-height:4rem;font-size:1.65rem;font-weight:600;text-decoration:none;border-radius:5px;transition:opacity .2s ease-in-out}.kg-btn:hover{opacity:.85}.kg-btn-accent{background-color:var(--ghost-accent-color,#1292EE);color:#fff}.kg-width-full.kg-card-hascaption{display:grid;grid-template-columns:inherit}.post-content table{border-collapse:collapse;width:100%}.post-content th{padding:.5em .8em;text-align:left;font-size:.75em;text-transform:uppercase}.post-content td{padding:.4em .7em}.post-content tbody tr:nth-child(2n+1){background-color:rgba(0,0,0,.1);padding:1px}.post-content tbody tr:nth-child(2n+2) td:last-child{box-shadow:inset 1px 0 rgba(0,0,0,.1),inset -1px 0 rgba(0,0,0,.1)}.post-content tbody tr:nth-child(2n+2) td{box-shadow:inset 1px 0 rgba(0,0,0,.1)}.post-content tbody tr:last-child{border-bottom:1px solid rgba(0,0,0,.1)}.page-footer{padding:60px 5vmin;margin:60px auto 0;text-align:center;background-color:#f8f8f8}.page-footer h3{margin:.5rem 0 0}.page-footer p{max-width:500px;margin:1rem auto 1.5rem;font-size:1.7rem;line-height:1.5em;color:rgba(0,0,0,.6)}.powered{display:inline-flex;align-items:center;margin:30px 0 0;padding:6px 9px 6px 6px;border:rgba(0,0,0,.1)1px solid;font-size:12px;line-height:12px;letter-spacing:-.2px;font-family:-apple-system,BlinkMacSystemFont,segoe ui,roboto,oxygen,ubuntu,cantarell,fira sans,droid sans,helvetica neue,sans-serif;font-weight:500;color:#222;text-decoration:none;background:#fff;border-radius:6px}.powered svg{height:16px;width:16px;margin:0 6px 0 0}@media(max-width:600px){body{font-size:1.6rem}h1{font-size:3rem}h2{font-size:2.2rem}}@media(max-width:400px){h1{font-size:2.6rem;line-height:1.15em}h2{font-size:2rem;line-height:1.2em}h3{font-size:1.7rem}}:root{--ghost-accent-color:#874efe}</style><style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript><script async src=https://cdn.ampproject.org/v0.js></script><body class=amp-template><header class=page-header><a href=https://codetiger.github.io/blog>Small World</a></header><main class=content role=main><article class=post><header class=post-header><h1 class=post-title>Sending large data like images over Lora</h1><section class=post-meta>Harishankar -
<time class=post-date datetime=2021-12-06>06 Dec 2021</time></section></header><section class=post-content><p>Got obsessed with the Lora module E32-868T30D after playing with it for couple of months now. To be honest, this seemed to me like a life saver for hobbyists to start on RF. My previous attempts failed with I had to add RF to my projects. This time it was mostly a plug and play with simple configurations.<h3 id=speed>Speed:</h3><p>I read everywhere saying Lora is for smaller data packets and are not meant for larger data like images. There were some calculations showing Lora would take hours or days to transfer a single image. These are not fully true and are mostly limited to certain providers. In my project I needed a P2P data transfer and it worked just fine.<p>Initially I started with transfering 40 bytes of sensor data every 5 seconds which worked just fine. After analysing the logs, I found that the Chip completes the air transmission in few milliseconds and just waits for more data. So I decided to push more data by breaking an image into chunks and rebuilding it on the receiver size.<p>An image of size 38KB takes me around 5 mins to transfer with enough delay inbetween to avoid the buffer overflows. There is no easy way to calculate the exact delay needed for each chunk to get transfered, or depending on AUX alone as well did not help my case much. So I've implemented a hybrid aproach that worked for me.<figure class="kg-card kg-image-card"></figure><h3 id=acknowledgement>Acknowledgement:</h3><p>In my implementation, the Lora class accepts file size of upto few megabytes and internally splits and sends it in chunks. The sender ensures if the chunk was received successfully by marking the chunk after getting an acknowledgement. The reason why AUX alone didn't work for me was, both the transceivers had to send and receive messages and the module didn't support duplex transmission. So a predefined interval of delay helped in my case. Otherwise, the 38KB image can be transferred in less than a minute.<h3 id=implementation>Implementation:</h3><p>The source code is available in my <a href=https://github.com/codetiger/rpi-hab/blob/main/lora.py>Github project</a>. The Lora class uses SQLite for keeping track of chunks and acknowledgements. This class is the same as explained in my previous post where I've explained the basics <a href=https://codetiger.github.io/blog/transfer-images-over-lora-e32-module/>integrating E32-868T30D with Raspberry Pi</a><p>Using this implementation, I've run the project for couple days in a row and there was no issue in buffer overflow. So this code is tested well but feel free to improve if you can find issues.</section></article></main><footer class=page-footer><h3>Small World</h3><p>Random ideas, and attempts<p><a href=https://codetiger.github.io/blog>Read more posts →</a></p><a class=powered href=https://ghost.org target=_blank rel=noopener><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 156 156"><g fill="none" fill-rule="evenodd"><rect fill="#15212b" width="156" height="156" rx="27"/><g transform="translate(36 36)" fill="#f6f8fa"><path d="M0 71.007A4.004 4.004.0 014 67h26a4 4 0 014 4.007v8.986A4.004 4.004.0 0130 84H4a4 4 0 01-4-4.007v-8.986zm50 0A4.004 4.004.0 0154 67h26a4 4 0 014 4.007v8.986A4.004 4.004.0 0180 84H54a4 4 0 01-4-4.007v-8.986z"/><rect y="34" width="84" height="17" rx="4"/><path d="M0 4.007A4.007 4.007.0 014.007.0h41.986A4.003 4.003.0 0150 4.007v8.986A4.007 4.007.0 0145.993 17H4.007A4.003 4.003.0 010 12.993V4.007z"/><rect x="67" width="17" height="17" rx="4"/></g></g></svg>Published with Ghost</a></footer>